import { Station } from '@/types';

// Ambulance stations with verified postcodes
export const defaultStations: Station[] = [
  {
    "id": "13",
    "name": "Ongar",
    "postcode": "CM5 9DT"
  },
  {
    "id": "1",
    "name": "Ampthill",
    "postcode": "MK45 2TG"
  },
  {
    "id": "2",
    "name": "Attleborough",
    "postcode": "NR17 2RR"
  },
  {
    "id": "3",
    "name": "Basildon",
    "postcode": "SS14 1GB"
  },
  {
    "id": "4",
    "name": "Beccles",
    "postcode": "NR34 7TJ"
  },
  {
    "id": "6",
    "name": "Berkhampstead",
    "postcode": "HP4 2DW"
  },
  {
    "id": "8",
    "name": "Billericay",
    "postcode": "CM12 9LL"
  },
  {
    "id": "9",
    "name": "Bishop's Stortford",
    "postcode": "CM23 2PY"
  },
  {
    "id": "10",
    "name": "Borehamwood",
    "postcode": "WD6 1JP"
  },
  {
    "id": "11",
    "name": "Braintree",
    "postcode": "CM7 2QF"
  },
  {
    "id": "12",
    "name": "Brentwood",
    "postcode": "CM15 9BS"
  },
  {
    "id": "14",
    "name": "Bury St Edmunds",
    "postcode": "IP32 7FQ"
  },
  {
    "id": "16",
    "name": "Canvey Island",
    "postcode": "SS8 9EG"
  },
  {
    "id": "17",
    "name": "Chelmsford",
    "postcode": "CM1 7FJ"
  },
  {
    "id": "18",
    "name": "Cheshunt",
    "postcode": "EN8 9LT"
  },
  {
    "id": "19",
    "name": "Clacton",
    "postcode": "CO15 4AH"
  },
  {
    "id": "20",
    "name": "Colchester",
    "postcode": "CO3 9AB"
  },
  {
    "id": "21",
    "name": "Cromer",
    "postcode": "NR27 9JR"
  },
  {
    "id": "22",
    "name": "Dereham",
    "postcode": "NR19 1BN"
  },
  {
    "id": "23",
    "name": "Diss",
    "postcode": "IP22 4ER"
  },
  {
    "id": "24",
    "name": "Downham Market",
    "postcode": "PE38 9SW"
  },
  {
    "id": "25",
    "name": "Dunmow",
    "postcode": "CM6 1LW"
  },
  {
    "id": "7",
    "name": "Barton Mills",
    "postcode": "IP28 6AE"
  },
  {
    "id": "62",
    "name": "Sudbury",
    "postcode": "CO10 1AZ"
  },
  {
    "id": "26",
    "name": "Ely",
    "postcode": "CB7 4PL"
  },
  {
    "id": "27",
    "name": "Fakenham",
    "postcode": "NR21 8NN"
  },
  {
    "id": "47",
    "name": "March",
    "postcode": "PE15 8ND"
  },
  {
    "id": "28",
    "name": "Felixstowe",
    "postcode": "IP11 2EX"
  },
  {
    "id": "29",
    "name": "Greenstead",
    "postcode": "CO4 3AD"
  },
  {
    "id": "30",
    "name": "Halstead",
    "postcode": "CO9 2HQ"
  },
  {
    "id": "5",
    "name": "Bedford",
    "postcode": "MK41 0UD"
  },
  {
    "id": "31",
    "name": "Harlow",
    "postcode": "CM20 1QP"
  },
  {
    "id": "32",
    "name": "Harwich",
    "postcode": "CO12 4TE"
  },
  {
    "id": "33",
    "name": "Haverhill",
    "postcode": "CB9 8HF"
  },
  {
    "id": "34",
    "name": "Hellesdon",
    "postcode": "NR6 5NA"
  },
  {
    "id": "35",
    "name": "Hemel Hempstead",
    "postcode": "HP2 5HA"
  },
  {
    "id": "36",
    "name": "Hunstanton",
    "postcode": "PE36 5HP"
  },
  {
    "id": "38",
    "name": "Ipswich",
    "postcode": "IP3 9SJ"
  },
  {
    "id": "39",
    "name": "Kempston",
    "postcode": "MK42 8AA"
  },
  {
    "id": "40",
    "name": "King's Lynn",
    "postcode": "PE30 4EU"
  },
  {
    "id": "41",
    "name": "Leighton Buzzard",
    "postcode": "LU7 3WJ"
  },
  {
    "id": "42",
    "name": "Letchworth",
    "postcode": "SG6 2AZ"
  },
  {
    "id": "43",
    "name": "Longwater",
    "postcode": "NR5 0JT"
  },
  {
    "id": "44",
    "name": "Loughton",
    "postcode": "IG10 2AS"
  },
  {
    "id": "45",
    "name": "Luton",
    "postcode": "LU1 1XL"
  },
  {
    "id": "46",
    "name": "Maldon",
    "postcode": "CM9 6ED"
  },
  {
    "id": "48",
    "name": "Martlesham Heath",
    "postcode": "IP5 3RG"
  },
  {
    "id": "49",
    "name": "Mildenhall",
    "postcode": "IP28 7NL"
  },
  {
    "id": "50",
    "name": "Newmarket",
    "postcode": "CB8 7SU"
  },
  {
    "id": "58",
    "name": "Southend",
    "postcode": "SS2 6UN"
  },
  {
    "id": "51",
    "name": "Potter Heigham",
    "postcode": "NR29 5HS"
  },
  {
    "id": "52",
    "name": "Potters Bar",
    "postcode": "EN6 2HF"
  },
  {
    "id": "53",
    "name": "Rayleigh",
    "postcode": "SS6 7UP"
  },
  {
    "id": "54",
    "name": "Saffron Walden",
    "postcode": "CB11 3NS"
  },
  {
    "id": "55",
    "name": "Saxmundham",
    "postcode": "IP17 1DZ"
  },
  {
    "id": "56",
    "name": "Shoebury",
    "postcode": "SS3 9BX"
  },
  {
    "id": "57",
    "name": "South Woodham Ferrers",
    "postcode": "CM3 5XH"
  },
  {
    "id": "60",
    "name": "St Neots",
    "postcode": "PE19 1DU"
  },
  {
    "id": "59",
    "name": "St. Ives",
    "postcode": "PE27 3WJ"
  },
  {
    "id": "61",
    "name": "Stansted",
    "postcode": "CM23 5SN"
  },
  {
    "id": "63",
    "name": "Swaffham",
    "postcode": "PE37 7HX"
  },
  {
    "id": "15",
    "name": "Cambridge - Paddocks",
    "postcode": "CB1 8DH"
  },
  {
    "id": "73",
    "name": "Cambridge",
    "postcode": "CB2 0QQ"
  },
  {
    "id": "74",
    "name": "Cambridge - Addenbrooks",
    "postcode": "CB2 2QP"
  },
  {
    "id": "75",
    "name": "Melbourn",
    "postcode": "SG8 6DE"
  },
  {
    "id": "76",
    "name": "Stevenage",
    "postcode": "SG1 1HS"
  },
  {
    "id": "77",
    "name": "Huntingdon",
    "postcode": "PE29 3AD"
  },
  {
    "id": "64",
    "name": "Thetford",
    "postcode": "IP24 1EU"
  },
  {
    "id": "65",
    "name": "Thurrock",
    "postcode": "RM17 5QS"
  },
  {
    "id": "66",
    "name": "Waltham Abbey",
    "postcode": "EN9 1HP"
  },
  {
    "id": "67",
    "name": "Watford",
    "postcode": "WD24 4PT"
  },
  {
    "id": "78",
    "name": "Waveney",
    "postcode": "NR31 7RQ"
  },
  {
    "id": "68",
    "name": "Weeley",
    "postcode": "CO16 9JR"
  },
  {
    "id": "69",
    "name": "Welwyn Garden City",
    "postcode": "AL7 4HL"
  },
  {
    "id": "70",
    "name": "Wickford",
    "postcode": "SS12 0EU"
  },
  {
    "id": "71",
    "name": "Wisbech",
    "postcode": "PE13 3AF"
  },
  {
    "id": "72",
    "name": "Witham",
    "postcode": "CM8 1PH"
  }
];

export function validatePostcode(postcode: string): boolean {
  // Basic UK postcode validation
  const ukPostcodeRegex = /^[A-Z]{1,2}\d{1,2}[A-Z]?\s?\d[A-Z]{2}$/i;
  return ukPostcodeRegex.test(postcode.trim());
}

export function findStationById(stations: Station[], id: string): Station | undefined {
  return stations.find(s => s.id === id);
}

export function findStationByName(stations: Station[], name: string): Station | undefined {
  return stations.find(s => s.name.toLowerCase() === name.toLowerCase());
}

export function findStationByPostcode(stations: Station[], postcode: string): Station | undefined {
  return stations.find(s => s.postcode.replace(/\s+/g, '').toUpperCase() === postcode.replace(/\s+/g, '').toUpperCase());
}

// Fuzzy matching for station names - handles variations like "Cambridge - Addenbrooks" matching "Cambridge"
export function findStationByNameFuzzy(stations: Station[], searchName: string): Station | undefined {
  const normalized = searchName.toLowerCase().trim();
  
  // First try exact match
  let match = findStationByName(stations, searchName);
  if (match) return match;
  
  // Try matching first word (e.g., "Cambridge - Addenbrooks" -> "Cambridge")
  const firstWord = normalized.split(/[\s-]+/)[0];
  match = stations.find(s => s.name.toLowerCase().startsWith(firstWord));
  if (match) return match;
  
  // Try partial match
  match = stations.find(s => {
    const stationName = s.name.toLowerCase();
    return stationName.includes(normalized) || normalized.includes(stationName);
  });
  
  return match;
}

// Normalize station name for matching
export function normalizeStationName(name: string): string {
  return name.toLowerCase()
    .replace(/\s+/g, ' ')
    .replace(/\s*-\s*/g, ' - ')
    .trim();
}
